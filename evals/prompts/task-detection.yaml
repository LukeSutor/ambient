# Task Detection Prompt

detect_tasks:
  template: |
    TASK: Find steps completed from screen changes.

    REQUIRED OUTPUT: {{"analysis":"Brief reason","completed":[step_numbers]}}

    PREVIOUS STATE:
    {previous_summary}

    NEW SCREEN CONTENT:
    {text}

    ACTIVE URL: {active_url}

    VALID STEPS TO CHECK:
    {tasks}

    DETECTION RULES:
    1. Only use step IDs from the task list above
    2. Compare previous state vs new screen content
    3. Mark complete only if NEW content proves step was finished
    4. Skip steps already marked "completed"
    5. Return [] if no new completions detected

    WHAT COUNTS AS COMPLETION:
    - New file/page appears matching step description
    - Success message for the specific action
    - URL change matching navigation step
    - Form submission confirmation

    FORMAT: {{"analysis":"One sentence why","completed":[valid_ids_only]}}
  description: "Main task detection prompt for identifying completed steps from screen changes"
detect_tasks_no_summary:
  template: |
    You are a task detection expert. You will be given all the text captured from a person's screen using accessibility APIs, and a list of tasks and their corresponding steps and completion status. It is your job to return which steps have been completed based on the content on the person's screen.

    Output JSON format:
    {{"analysis":"<reasoning for why steps are completed>","completed":[<completed step IDs>]}}

    Rules:
    - Make sure your reasoning is clear and concise. It shouldn't be too long, two sentences at most
    - Ensure to only include step IDs that are present in the list of tasks provided
    - Do not include a step in the completed array if it is already marked complete
    - If there are no completed steps, return an empty array

    <tasks>
    {tasks}
    </tasks>

    <screen_text>
    {text}
    </screen_text>

    <active_url>
    {active_url}
    </active_url>

    IMPORTANT: Only mark task complete if screen shows clear evidence.

    Once more:
    You are a task detection expert. You will be given all the text captured from a person's screen using accessibility APIs, and a list of tasks and their corresponding steps and completion status. It is your job to return which steps have been completed based on the content on the person's screen.
    - Make sure your reasoning is clear and concise. It shouldn't be too long, two sentences at most
    - Ensure to only include step IDs that are present in the list of tasks provided
    - Do not include a step in the completed array if it is already marked complete
    - If there are no completed steps, return an empty array
  description: "Task detection prompt without previous summary for identifying completed steps from entire screen text"