# Task Detection Prompt

detect_tasks:
  template: |
    TASK: Detect which steps completed based on screen changes.

    OUTPUT: {{"analysis":"<why step completed>","completed":[<step IDs>]}}

    <previous_summary>
    {previous_summary}
    </previous_summary>

    <new_screen_text>
    {text}
    </new_screen_text>

    URL: {active_url}

    <tasks>
    {tasks}
    </tasks>

    KEY RULE: Analysis must explain WHY a step is done, NOT summarize screen.

    ANALYZE THE CHANGES:
    1. Previous summary = what user WAS doing
    2. New text = what CHANGED on screen
    3. Your job = identify COMPLETED steps from changes

    CRITICAL RULES:
    - Only mark step complete if NEW text proves completion
    - Analysis = reasoning about task completion (not screen summary!)
    - Skip already-complete steps
    - Empty array if nothing new completed
    - Max 2 sentences reasoning

    REMEMBER: {{"analysis":"<why step completed>","completed":[<step IDs>]}}
    Focus on TASK COMPLETION evidence, not general screen activity. Maximum 2 sentences analysis.
  description: "Main task detection prompt for identifying completed steps from screen changes"
